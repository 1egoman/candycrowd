<!-- footer -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.7/socket.io.min.js"></script>
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script>
  var socket = io()
  socket.on("new:house:ack", function(p) {
    console.log("Got a response: "+JSON.stringify(p))
    get_houses()
  })
  socket.on("get:house:ack", function(h) {
    $(".house-container").html(JSON.stringify(h, null, 2))
  })

  // add a new house with the current location
  add_new_house = function(rating) {
    navigator.geolocation.getCurrentPosition(function(coords) {
      socket.emit("new:house", {
        rating: rating,
        lat: coords.coords.latitude,
        lng: coords.coords.longitude
      })
    })
  }

  get_houses = function() {
    socket.emit("get:house")
  }

  new_house = function() {
    add_new_house(parseInt($(".ratings-box").val()))
  }
  get_houses()
</script>
